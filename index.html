<script>
    // URLs DE TUS SCRIPTS (Aseg√∫rate de que sean las versiones m√°s recientes implementadas como "Anyone")
    const SCRIPT_MAESTRO = "https://script.google.com/macros/s/AKfycby00KgGDV_jcFJp7rh58z8xu9h_RIQiAONy2g_qneAaBF1U_GoJJ1dDCBjBfzl60Q0DvA/exec";
    const SCRIPT_M10 = "https://script.google.com/macros/s/AKfycbyPLUTz_H2UzNK-_CJzf64_ySjh6WKR1KfsfF7EHcnvselfJ4Sa4WdFI9jAFI22NmqYcw/exec";
    const SCRIPT_VIP = "https://script.google.com/macros/s/AKfycbz6FgSJlMjESDrIUxyM1yfOgHbwTF_WKbZFfua-YRtQ-PbGMgpZprF_4F8gXueTAjSe8w/exec";

    // LEY IMSS
    function consultarLey() {
        const anio = document.getElementById('anioInput').value;
        const box = document.getElementById('resultadoBox');
        if (anio < 1940 || anio > 2026) return alert("A√±o inv√°lido");
        box.classList.remove('hidden');
        const resTitle = document.getElementById('resTitle');
        const resDesc = document.getElementById('resDesc');
        if (anio < 1997) {
            resTitle.innerText = "¬°Eres Ley 73!";
            resDesc.innerText = "Tienes derecho a pensi√≥n vitalicia. Modalidad 40 es tu mejor aliada.";
        } else {
            resTitle.innerText = "Eres Ley 97";
            resDesc.innerText = "Tu pensi√≥n depende de tu AFORE. Necesitas ahorro voluntario.";
        }
    }

    // ESTATUS
    async function ejecutarConsulta() {
        const f = document.getElementById("folio_busqueda").value.trim().toUpperCase();
        const c = document.getElementById("curp_busqueda").value.trim().toUpperCase();
        const resBox = document.getElementById("resEstatus");
        if(!f || !c) return alert("Completa los campos");
        resBox.innerHTML = "üîç Buscando...";
        try {
            const resp = await fetch(`${SCRIPT_MAESTRO}?curp=${encodeURIComponent(c)}&folio=${encodeURIComponent(f)}`);
            const data = await resp.json();
            if(data.encontrado) {
                resBox.innerHTML = `<div class="p-6 bg-blue-100 border-2 border-blue-900 rounded-xl font-black text-blue-900 uppercase">Estatus: ${data.status}</div>`;
            } else {
                resBox.innerHTML = "<p class='text-red-600 font-bold'>No encontrado.</p>";
            }
        } catch (e) { resBox.innerHTML = "Error de conexi√≥n."; }
    }
    <section id="documentos" class="section-padding max-w-6xl mx-auto">
        <div class="bg-slate-900 rounded-[3rem] p-10 md:p-16 text-white shadow-2xl relative overflow-hidden">
            <div class="relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div>
                    <span class="bg-blue-600 text-white px-4 py-1.5 rounded-full text-xs font-black uppercase">Gesti√≥n Documental</span>
                    <h2 class="text-4xl font-black mt-6 mb-4 uppercase tracking-tighter">Solicitud de Documentos Oficiales</h2>
                    <p class="text-blue-100 text-lg">¬øNecesitas ayuda para obtener tus documentos del IMSS o AFORE? Nosotros los gestionamos por ti de manera segura y r√°pida.</p>
                    <ul class="mt-6 space-y-3 text-sm text-blue-200">
                        <li>‚úì Constancia de Semanas Cotizadas</li>
                        <li>‚úì Expediente de Identificaci√≥n AFORE</li>
                        <li>‚úì Estado de Cuenta Hist√≥rico</li>
                    </ul>
                </div>
                <div class="bg-white p-8 rounded-[2rem] text-slate-800 shadow-xl">
                    <label>Tu CURP:</label>
                    <input type="text" id="doc_curp" maxlength="18" placeholder="Ingresa tu CURP">
                    
                    <label>Tipo de Documento:</label>
                    <select id="doc_tipo">
                        <option value="Semanas Cotizadas">Constancia de Semanas Cotizadas</option>
                        <option value="Vigencia Derechos">Vigencia de Derechos</option>
                        <option value="Correccion Datos">Correcci√≥n de Datos Personales</option>
                        <option value="Baja Patronal">Baja Patronal / Historial</option>
                    </select>

                    <button onclick="solicitarDocumento()" id="btnDoc" class="bg-blue-600 text-white w-full py-4 rounded-xl font-black uppercase mt-8 hover:bg-blue-500 transition-all shadow-lg tracking-widest">Solicitar Documento</button>
                    
                    <div id="exitoDoc" class="hidden text-center mt-4 p-4 bg-green-50 border border-green-200 rounded-xl text-green-700 font-bold">
                        ¬°Solicitud Registrada! Folio: <span id="folioDoc_ver"></span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    // ANALISIS R√ÅPIDO (CORREGIDO)
    function enviarRapido() {
        const n = document.getElementById("nombreR").value;
        const t = document.getElementById("telR").value;
        const c = document.getElementById("curpR").value; // Captura CURP
        const s = document.getElementById("nssR").value;  // Captura NSS
        
        if(!n || t.length < 10 || !c || !s) return alert("Completa todos los campos (Nombre, CURP, NSS y WhatsApp)");
        
        const folio = "R-" + Math.floor(1000 + Math.random() * 9000);
        
        fetch(SCRIPT_MAESTRO, { 
            method: 'POST', 
            mode: 'no-cors', 
            body: JSON.stringify({ 
                nombre: n, 
                tel: t, 
                curp: c, 
                nss: s, 
                folio: folio, 
                tipo: "AnalisisRapido" 
            }) 
        });
        
        document.getElementById("exitoR").classList.remove("hidden");
        document.getElementById("folioR_ver").innerText = folio;
    }

    // ANALISIS DETALLADO (CORREGIDO)
    function enviarDetallado() {
        const n = document.getElementById("nombreD").value;
        const t = document.getElementById("telD").value;
        const c = document.getElementById("curpD").value; // Captura CURP
        const s = document.getElementById("nssD").value;  // Captura NSS
        
        if(!n || t.length < 10 || !c || !s) return alert("Completa todos los campos");
        
        const folio = "D-" + Math.floor(1000 + Math.random() * 9000);
        
        fetch(SCRIPT_MAESTRO, { 
            method: 'POST', 
            mode: 'no-cors', 
            body: JSON.stringify({ 
                nombre: n, 
                tel: t, 
                curp: c, 
                nss: s, 
                folio: folio, 
                tipo: "Detallado" 
            }) 
        });
        
        document.getElementById("exitoD").classList.remove("hidden");
        document.getElementById("folioD_ver").innerText = folio;
    }

    // MODALIDAD 10
    function validarYEnviarM10() {
        const n = document.getElementById("m10_nombre").value;
        const t = document.getElementById("m10_tel").value;
        const id = document.getElementById("m10_id").value; // CURP/NSS
        const sal = document.getElementById("m10_salario").value;
        const dom = document.getElementById("m10_dom").value;
        
        if(!n || t.length < 10 || !id) return alert("Completa los datos principales");
        
        const folio = "M10-" + Math.floor(1000 + Math.random() * 9000);
        
        fetch(SCRIPT_M10, { 
            method: 'POST', 
            mode: 'no-cors', 
            body: JSON.stringify({ 
                nombre: n, 
                tel: t, 
                id_tramite: id, 
                salario: sal, 
                domicilio: dom, 
                folio: folio 
            }) 
        });
        
        document.getElementById("exitoM10").classList.remove("hidden");
        document.getElementById("folioM10_ver").innerText = folio;
        document.getElementById("m10_link_wpp").href = `https://wa.me/528131983700?text=Hola,%20adjunto%20comprobante%20folio%20${folio}`;
    }

    // VIP ZOOM
    async function cargarHorarios() {
        const select = document.getElementById('horaV');
        select.innerHTML = '<option>Cargando horarios...</option>';
        const horas = ["10:00 AM", "11:00 AM", "12:00 PM", "01:00 PM", "02:00 PM", "03:00 PM", "04:00 PM", "05:00 PM"];
        setTimeout(() => {
            select.innerHTML = '<option value="">Elige Hora</option>';
            horas.forEach(h => { let o = document.createElement('option'); o.value = h; o.text = h; select.add(o); });
        }, 800);
    }

    function agendarVip() {
        const n = document.getElementById("nombreV").value;
        const t = document.getElementById("telV").value;
        const d = document.getElementById("diaV").value;
        const h = document.getElementById("horaV").value;
        if(!n || !d || !h) return alert("Completa datos");
        
        fetch(SCRIPT_VIP, { 
            method: 'POST', 
            mode: 'no-cors', 
            body: JSON.stringify({ 
                nombre: n, 
                tel: t, 
                cita: d + " " + h 
            }) 
        });
        
        document.getElementById("exitoVIP").classList.remove("hidden");
    }
</script>

